<% if messages.present? %>
  <div class="message">
    <% messages.each do |m| %>
      <div class="user-message">
        <p><%= l m.created_at %></p>
        <p class="dm-content"><%= m.content %></p>
        <div class="dm-image">
          <% if m.protector_id == nil %>
            <% if m.user.image.attached? %> 
              <%= image_tag m.user.image.variant(combine_options:{gravity: :center, resize:"30x30^", crop:"30x30+0+0"}).processed %>
            <% else %>
              <%= image_tag "user_default.png", :size => "40x40" %>
            <% end %>
          <% else %>
            <% if m.protector.image.attached? %> 
              <%= image_tag m.protector.image.variant(combine_options:{gravity: :center, resize:"30x30^", crop:"30x30+0+0"}).processed %>
            <% else %>
              <%= image_tag "protector_default.png", :size => "40x40" %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <h3 class="text-center">メッセージはまだありません</h3>
<% end %>